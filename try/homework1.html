<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <title>è³ªæ•¸è·Ÿè‘—å°äººå‡ºç¾</title>

    <!-- å¼•å…¥ dotlottie Web Componentï¼ˆä¸€å®šè¦æœ‰é€™æ®µï¼‰ -->
    <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.5/dist/dotlottie-wc.js" type="module">

    </script>


    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f3f7b3;
            color: #6082c4;
            text-align: center;
        }

        .stage {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 20px auto;
            /* å…ˆé ç•™èˆå°å¤§å°ï¼Œè£¡é¢æœƒæ”¾äººï¼‹æ•¸å­— */
        }

        /* è³ªæ•¸ç–Šåœ¨èˆå°åº•éƒ¨ */
        #prime-container {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
            pointer-events: none;
        }

        .prime-box {
            padding: 4px 6px;
            border-radius: 800px;
            border: 2.5px solid #f7a34a;
            background: #6082c4;
            color: #fefce8;
            font-size: 12px;
            animation: pop-in 0.4s ease-out;
        }

        @keyframes pop-in {
            0% {
                transform: scale(0.3) translateY(10px);
                opacity: 0;
            }

            100% {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }



        button {
            margin: 0 6px;
            padding: 6px 12px;
            border-radius: 8px;
            border: none;
            background: #6082c4;
            color: white;
            cursor: pointer;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>

<body>
    <h1 id='titleName'>æ±‚å‡º 1â€“100 çš„è³ªæ•¸</h1>

    <div>
        <button type="button" id="btn_start">é–‹å§‹é¡¯ç¤ºè³ªæ•¸</button>
        <button type="button" id="btn_reset">æ¸…é™¤é‡æ–°é–‹å§‹</button>
    </div>

    <!-- èˆå°ï¼šæŒ‰é–‹å§‹æ™‚æ‰æœƒåœ¨é€™è£¡æ”¾ dotlottie-wc -->
    <div class="stage" id="stage">
        <div id="prime-container"></div>
    </div>

    <script>
        // 1. åˆ¤æ–·æ˜¯å¦ç‚ºè³ªæ•¸
        function isPrime(n) {
            if (n < 2) return false;
            for (let i = 2; i <= Math.sqrt(n); i++) {
                if (n % i === 0) return false;
            }
            return true;
        }

        // 2. å…ˆæŠŠ 1â€“100 çš„è³ªæ•¸å­˜èµ·ä¾†
        const primes = [];
        for (let n = 1; n <= 100; n++) {
            if (isPrime(n)) {
                primes.push(n);
            }
        }

        const stage = document.getElementById('stage');
        const container = document.getElementById('prime-container');
        const btnStart = document.getElementById('btn_start');
        const btnReset = document.getElementById('btn_reset');

        let index = 0;      // ç›®å‰é¡¯ç¤ºåˆ°ç¬¬å¹¾å€‹è³ªæ•¸
        let timerId = null; // è¨ˆæ™‚å™¨ç·¨è™Ÿ

        // ğŸ”¹ å»ºç«‹å°äººå‹•ç•«å…ƒç´ ï¼ˆåªåœ¨éœ€è¦æ™‚å»ºç«‹ï¼‰
        function createLottieIfNeeded() {
            let player = stage.querySelector('#person');
            if (!player) {
                player = document.createElement('dotlottie-wc');
                player.setAttribute('src', 'https://lottie.host/e17c0b85-beb5-44e1-927b-af1e8e26c38b/HX72rw4AVH.lottie');
                player.setAttribute('autoplay', '');
                player.setAttribute('loop', '');
                player.style.width = '100%';
                player.style.height = '100%';
                player.id = 'person';
                // æ”¾åœ¨ prime-container å‰é¢ï¼Œé€™æ¨£è³ªæ•¸æœƒè“‹åœ¨æœ€ä¸Šå±¤
                stage.insertBefore(player, container);
            }
        }

        // ğŸ”¹ æŠŠå°äººå‹•ç•«ç§»é™¤
        function removeLottieIfExists() {
            const player = stage.querySelector('#person');
            if (player) {
                stage.removeChild(player);
            }
        }

        // æŠŠç…™ç«ç§»é™¤
        function removefire() {
            const fire = stage.querySelector('#fire');
            if (fire) {
                stage.removeChild(fire)
            }
        }

        // 3. é¡¯ç¤ºä¸‹ä¸€å€‹è³ªæ•¸
        function showNextPrime() {
            if (index >= primes.length) {
                clearInterval(timerId);
                timerId = null;
                // btnStart.disabled = false;
                container.innerHTML = ''; // æ¸…ç©ºè³ªæ•¸
                index = 0;
                removeLottieIfExists();   // äººæ¶ˆå¤±
                removeLottieIfExists();
                createfire();
                const title = document.getElementById('titleName');
                title.textContent = 'æ­å–œå®Œæˆ!';
                return;

            }

            const span = document.createElement('span');
            span.textContent = primes[index];
            span.className = 'prime-box';
            container.appendChild(span);

            index++;
        }

        // 4. é–‹å§‹æŒ‰éˆ•ï¼šå»ºç«‹å°äºº + é–‹å§‹ä¾åºé¡¯ç¤ºè³ªæ•¸
        btnStart.addEventListener('click', function () {
            if (timerId !== null) return; // å·²ç¶“åœ¨è·‘å°±ä¸è¦é‡è¤‡

            createLottieIfNeeded();  // äººå‡ºç¾

            showNextPrime();         // å…ˆé¡¯ç¤ºç¬¬ä¸€å€‹
            timerId = setInterval(showNextPrime, 400); // ä¹‹å¾Œæ¯ 0.5 ç§’ä¸€å€‹
            btnStart.disabled = true;
        })


        // 5. æ¸…é™¤æŒ‰éˆ•ï¼šåœæ‰è¨ˆæ™‚å™¨ã€æ¸…ç©ºè³ªæ•¸ã€æŠŠäººç§»é™¤
        btnReset.addEventListener('click', function () {
            if (timerId !== null) {
                clearInterval(timerId);
                timerId = null;
            }
            container.innerHTML = ''; // æ¸…ç©ºè³ªæ•¸
            index = 0;
            btnStart.disabled = false;
            removeLottieIfExists();   // äººæ¶ˆå¤±
            removefire();
            document.getElementById('titleName').textContent = 'æ±‚å‡º 1â€“100 çš„è³ªæ•¸';
        });


        //åŠ å…¥ç…™ç«:
        function createfire() {
            let fire = stage.querySelector('#fire');
            if (!fire) {
                fire = document.createElement('dotlottie-wc');
                fire.setAttribute('src', 'https://lottie.host/e66e2d08-e237-423d-b511-0906f4f7bc44/uajsqXS5zs.lottie');
                fire.setAttribute('autoplay', '');
                fire.setAttribute('loop', '');
                fire.id = 'fire';
                fire.style.width = '100%';
                fire.style.height = '100%';
                // æ”¾åœ¨ prime-container å‰é¢ï¼Œé€™æ¨£è³ªæ•¸æœƒè“‹åœ¨æœ€ä¸Šå±¤
                stage.insertBefore(fire, container);
            }
        }







    </script>
</body>

</html>